<!doctype html>
<html lang="zh">
<head>
    <!-- http://10.10.22.212:32123/jar-runner.jar -->
    <meta charset="UTF-8">
    <meta name="viewport"
          content="width=device-width, user-scalable=no, initial-scale=1.0, maximum-scale=1.0, minimum-scale=1.0">
    <meta http-equiv="X-UA-Compatible" content="ie=edge">
    <style>
        div.block {
            display: inline-block;
            max-width: 30em;
            margin: 1em;
        }

        div.block .title {
            font-size: 120%;
        }

        div.block .field .label {
            display: inline-block;
            min-width: 5em;
            color: #a1d5ff;
        }

        div.block .field {
            padding: 0.2em 0.5em;
            background-color: dodgerblue;
            color: white;
        }
    </style>
    <script src="js/jquery-3.3.1.js"></script>
    <script>
        var parseData = function (result) {
            if (result.code !== 0) {
                $('#message').html(result.message);
                return;
            }

            if (!result.data || !result.data.statuses) {
                return;
            }

            var statuses = result.data.statuses;

            $('#blocks').empty();
            $.each(statuses, function (index, status) {
                $('<div>').addClass('block')
                    .append($('<div>').addClass('title').html(status.host))
                    .append($('<div>').addClass('field')
                        .append($('<span>').addClass('label').html('CPU'))
                        .append($('<span>').addClass('value').html(status.cpu_usage))
                    )
                    .append($('<div>').addClass('field')
                        .append($('<span>').addClass('label').html('Memory'))
                        .append($('<span>').addClass('value').html(status.mem_total))
                    )
                    .append($('<div>').addClass('field')
                        .append($('<span>').addClass('label').html('&nbsp;'))
                        .append($('<span>').addClass('value').html(status.mem_usage))
                    )
                    .append($('<div>').addClass('field')
                        .append($('<span>').addClass('label').html('Swap'))
                        .append($('<span>').addClass('value').html(status.swap_total))
                    )
                    .append($('<div>').addClass('field')
                        .append($('<span>').addClass('label').html('&nbsp;'))
                        .append($('<span>').addClass('value').html(status.swap_usage))
                    )
                    .appendTo('#blocks');
            });
        };

        var queryData = function () {
            $.get("data", {}, parseData);
        };

        $(function() {
            queryData();
            setInterval(queryData, 5000);
        });
    </script>
    <title>SysMon</title>
</head>
<body>
<div id="message"></div>

<div id="blocks">

</div>
</body>
</html>